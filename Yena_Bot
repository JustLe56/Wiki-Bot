import discord
import wikipedia
from discord.ext import commands

client = commands.Bot(command_prefix = '!') #creates prefix for all commands 

@client.event
async def on_ready():
    print("I am alive") #displays in terminal when the bot is online


@client.command()
async def ping(ctx): #all commands take in context parameter(ctx) for information regarding message
    await ctx.send('pong') #test bot ability to send and receive discord messages


@client.command()
async def wikiSum(ctx,userInput): #takes in string inputted in the same line as command as the topic to search for
    try: #takes user input as arg and prints "4" lines of Wikipedia summary
            await ctx.send(format(wikipedia.summary(userInput,sentences=4)))
    except wikipedia.exceptions.DisambiguationError as e: #Disambiguation error message
            await ctx.send(format(("Error: {0}".format(e))))
            await ctx.send("Error: too many results, please try again with more details.")

@client.command()
async def wikiPic(ctx,userInput):
    try:
          picFind = wikipedia.page(userInput) #creates variable containing wikipedia page of userInput
          await ctx.send("Picture from: <{}>".format(picFind.url)) #gives url of wikipedia page as context of the following image
          await ctx.send(picFind.images[0]) #gives url of an image from wikipedia page

    except wikipedia.exceptions.DisambiguationError as e:
            await ctx.send(format(("Error: {0}".format(e))))
            await ctx.send("Please try again with more details.")

@client.command()
async def self(ctx):
        commands={}
        commands['!pong']='Tests the bot\'s response time'
        commands['!self']='You just entered this command...'
        commands['!wikiSum']='Gives Wikipedia summary of entered text'
        commands['!wikiPic']='Gives Wikipedia picture of entered text'

        msg=discord.Embed(title='Yena Bot Commands', description="Written by Day56#6042",color=0xf4bf42)

        for command,description in commands.items():
            msg.add_field(name=command,value=description, inline=False)
            
        await ctx.send(embed=msg)



client.run('NTY4NjAzMjc2NTUyMDQ0NTU0.XLkgGQ.BgWi6DSV8NOVzrvp5Xmn3LVv1ww') #connects bot to discord server
